<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Petshop</title>
    <link rel="stylesheet" href="../css/index.css" />
    <link rel="shortcut icon" href="../assets/title.svg" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Alegreya:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,800;1,900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
      <nav class="header__nav">
        <div>
          <a href="index.html" class="header__logo">
            <img src="../assets/title.svg" alt="" />
            <h4>PetShop</h4>
          </a>
        </div>
        <ul class="header__menu">
          <li><a href="index.html#proizvodi">Proizvodi</a></li>
          <li><a href="admin.html">Admin</a></li>
          <li><a href="about-us.html">O nama</a></li>
          <li><a href="#" onclick="openForm()">Prijavite se</a></li>
        </ul>
        <div class="menu-cart">
          <ul class="header__menu-mobile">
            <li>
              <img
                src="../assets/menu.svg"
                alt="menu"
                class="hamburger"
                id="mobileMenuBtn"
              />
            </li>
          </ul>
          <div class="cart">
            <a href="cart.html">
              <img src="../assets/shopping-cart-icon.png" alt="cart" />
            </a>
          </div>
        </div>
      </nav>

      <div class="mobile-menu-container" id="mobileMenu">
        <span class="close-btn" onclick="closeMobileMenu()">&times;</span>
        <ul class="mobile-menu">
          <li><a href="index.html#proizvodi">Proizvodi</a></li>
          <li><a href="admin.html">Admin</a></li>
          <li><a href="about-us.html">O nama</a></li>
          <li><a href="#" onclick="openForm()">Prijavite se</a></li>
        </ul>
      </div>
    </header>

    <section class="hero">
      <div class="hero__left">
        <h4>Najbolji proizvodi za vase ljubimce</h4>
        <h2>
          Hrana i igracke <br />
          Za sve zivotinje
        </h2>
        <button onclick="openForm()">Prijavite se</button>
      </div>
      <div class="hero__right">
        <img src="../assets/bg-pets.png" alt="hero-photo" />
      </div>
    </section>
    <div>
      <div class="login__popup" id="popup">
        <form action="#" class="form__container" id="prijava">
          <h1>Prijava</h1>

          <label for="email"><b>Email</b></label>
          <input type="text" placeholder="Enter Email" name="email" required />

          <label for="password"><b>Lozinka</b></label>
          <input
            type="password"
            placeholder="Enter Password"
            name="password"
            required
          />
          <div>
            <button type="button" onclick="closeForm()" class="btn">
              Prijavite se
            </button>
            <button type="button" class="btn" onclick="closeForm()">
              Nazad
            </button>
          </div>
          <p onclick="openReg()">Registrujte se</p>
        </form>
        <div>
          <form id="registracija" style="display: none" class="form__container">
            <label for="ime">Ime:</label>
            <input type="text" id="ime" required /><br />

            <label for="prezime">Prezime:</label>
            <input type="text" id="prezime" required /><br />

            <label for="datumRodjenja">Datum rođenja:</label>
            <input type="date" id="datumRodjenja" required /><br />

            <label for="adresa">Adresa:</label>
            <input type="text" id="adresa" required /><br />

            <label for="email">Email:</label>
            <input type="email" id="email" required /><br />

            <label for="telefon">Telefon:</label>
            <input type="tel" id="telefon" required /><br />

            <label for="korisnickoIme">Korisničko ime:</label>
            <input type="text" id="korisnickoIme" required /><br />

            <label for="lozinka">Lozinka:</label>
            <input type="password" id="lozinka" required /><br />

            <button type="submit" class="btn" id="submit">Potvrdi</button>
          </form>
        </div>
      </div>
    </div>

    <section class="products" id="proizvodi">
      <div class="grid" id="proizvodiContainer">
        <!-- <div class="card">
          <a href="productDetails.html">
            <img src="../assets/hranaPsi.jpg" alt="petshop" />
            <h1>Hrana za pse</h1>
            <p class="cena">RSD 500</p>
            <p>Najukusnija hrana za pse</p>
            <button>Dodaj u korpu</button>
          </a>
        </div> -->
      </div>
    </section>
    <footer class="footer">
      <div>
        <img src="../assets/title.svg" alt="" class="footer__img" />
      </div>
      <div>
        <h2>Linkovi</h2>
        <ul class="links">
          <li><a href="index.html#proizvodi">Proizvodi</a></li>
          <li><a href="#admin__links">Admin</a></li>
          <li><a href="about-us.html">O nama</a></li>
          <li><a href="#" onclick="openForm()">Prijavite se</a></li>
        </ul>
      </div>
      <div>
        <h2>Admin</h2>
        <ul class="links" id="admin__links">
          <li><a href="ListOfProducts.html">Proizvodi</a></li>

          <li><a href="listOfUsers.html">Korisnici</a></li>
        </ul>
      </div>
      <div>
        <h2>Zapratite nas</h2>
        <ul class="links social">
          <li>
            <a href="#">
              <img src="../assets/square-facebook.svg" alt="" /> Facebook</a
            >
          </li>
          <li>
            <a href="#"
              ><img src="../assets/square-instagram.svg" alt="" /> Instagram</a
            >
          </li>
          <li>
            <a href="#"
              ><img src="../assets/square-twitter.svg" alt="" /> Twitter</a
            >
          </li>
        </ul>
      </div>
    </footer>
    <div class="after__footer">
      <p>Made by FTN &copy;</p>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import {
        getDatabase,
        ref,
        onValue,
        update,
        set,
        get,
        child,
      } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
      function openProductDetails(proizvodKey) {
        const productDetailsUrl = `productDetails.html?key=${proizvodKey}`;
        window.location.href = productDetailsUrl;
      }
      const firebaseConfig = {
        apiKey: "AIzaSyDSN0vbu-NWOLwJJHpAbhanlns666rGgRk",
        authDomain: "petshop-200ae.firebaseapp.com",
        databaseURL: "https://petshop-200ae-default-rtdb.firebaseio.com",
        projectId: "petshop-200ae",
        storageBucket: "petshop-200ae.appspot.com",
        messagingSenderId: "332500787103",
        appId: "1:332500787103:web:4b5ba921b52d4bce9f27aa",
      };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);
      const proizvodiRef = ref(db, "proizvodi" + "/-MNVEu6iMr2EFlQO6TW60");

      onValue(proizvodiRef, (snapshot) => {
        const proizvodi = snapshot.val();
        console.log(proizvodi);
      });
      document.getElementById("submit").addEventListener("click", function (e) {
        e.preventDefault();
        var ime = document.getElementById("ime").value;
        var prezime = document.getElementById("prezime").value;
        var datumRodjenja = document.getElementById("datumRodjenja").value;
        var adresa = document.getElementById("adresa").value;
        var email = document.getElementById("email").value;
        var telefon = document.getElementById("telefon").value;
        var korisnickoIme = document.getElementById("korisnickoIme").value;
        var lozinka = document.getElementById("lozinka").value;
        if (korisnickoIme.length < 5) {
          alert("Korisničko ime mora imati barem 5 karaktera.");
          return;
        }
        if (lozinka.length < 8) {
          alert("Lozinka mora imati barem 8 karaktera.");
          return;
        }
        var korisnik = {
          ime: ime,
          prezime: prezime,
          datumRodjenja: datumRodjenja,
          adresa: adresa,
          email: email,
          telefon: telefon,
          korisnickoIme: korisnickoIme,
          lozinka: lozinka,
        };

        set(ref(db, "korisnici/" + korisnickoIme), korisnik);

        alert("Korisnik uspešno dodat u bazu!");
      });

      const proizvodiContainer = document.getElementById("proizvodiContainer");

      onValue(proizvodiRef, (snapshot) => {
        const proizvodi = snapshot.val();
        proizvodiContainer.innerHTML = "";
        for (const proizvodKey in proizvodi) {
          const proizvod = proizvodi[proizvodKey];

          const cardDiv = document.createElement("div");
          cardDiv.classList.add("card");

          const anchorTag = document.createElement("a");

          const imgTag = document.createElement("img");
          imgTag.alt = "Slika nije dostupna";
          imgTag.src = proizvod.slike[0];
          imgTag.addEventListener("click", () => {
            openProductDetails(proizvodKey);
          });
          const h1Tag = document.createElement("h1");
          h1Tag.textContent = proizvod.naziv;

          const cenaTag = document.createElement("p");
          cenaTag.classList.add("cena");
          cenaTag.textContent = `RSD ${proizvod.cena}`;

          const pTag = document.createElement("p");
          pTag.textContent = proizvod.opis;

          const buttonTag = document.createElement("button");
          buttonTag.textContent = "Dodaj u korpu";
          buttonTag.style.zIndex = "1000000";
          buttonTag.addEventListener("click", function (e) {
            e.preventDefault();
            let noviProizvod = { ...proizvod, uKorpi: true };
            console.log(noviProizvod);
            set(
              ref(db, "proizvodi/" + "-MNVEu6iMr2EFlQO6TW60/" + proizvodKey),
              noviProizvod
            );
          });

          anchorTag.appendChild(imgTag);
          anchorTag.appendChild(h1Tag);
          anchorTag.appendChild(cenaTag);
          anchorTag.appendChild(pTag);
          anchorTag.appendChild(buttonTag);
          cardDiv.appendChild(anchorTag);

          proizvodiContainer.appendChild(cardDiv);
        }
      });
    </script>
    <script src="../js/index.js"></script>
  </body>
</html>
